# Разработка моделей машинного обучения, прогнозирующих удой коровы и рассчитывающих вероятность получить вкусное молоко

## Введение
Фермер, владелец молочного хозяйства «Вольный луг», хочет купить бурёнок, чтобы расширить поголовье стада коров. Для этого он заключил выгодный контракт с ассоциацией пастбищ «ЭкоФерма».
Условия позволяют фермеру очень тщательно отобрать коров. Он определяет качество молока по строгой методике, и при этом ему нужно выполнять свой план развития молочного хозяйства. Фермер хочет, чтобы каждая бурёнка давала не менее 6000 килограммов молока в год, а её надой был вкусным — строго по его критериям, ничуть не хуже. А продавцы и технологи так и норовят приукрасить своих коровок!
Поэтому он просит разработать модель машинного обучения, которая поможет ему управлять рисками и принимать объективное решение о покупке. «ЭкоФерма» готова предоставить подробные данные о своих коровах. 
С помощью модели нужно отобрать коров по двум критериям:
- средний удой за год — не менее 6000 килограммов;
- молоко должно быть вкусным.

## Цель исследования
Создать 2 модели машинного обучения, одна из которых будет прогнозировать возможный удой коровы, а другая - рассчитывать вероятность получения вкусного молока от коровы.
Эти модели помогут Заказчику (фермеру) управлять рисками и принимать объективное решение о покупке коров у "ЭкоФермы".

## Ход исследования
1. Загрузка данных и первый взгляд на них;
2. Предобработка данных: поиск и исправление ошибок в исходных данных;
3. Исследовательский анализ данных: описание и визуализация представленной информации, поиск закономерностей;
4. Создание моделей линейной регрессии и прогноз целевого признака по лучшей из них;
5. Создание модели логистической регрессии и прогноз целевого признака;
6. Выводы.

## Общие выводы
Фермер может купить 1 корову с вкусным молоком и удоем более 6 000 кг (и удоем, попадающим в доверительный интервал) с минимальным риском для себя.
Требуемый удой прогнозируется более, чем для 2 коров, однако модель классификации уменьшила выборку исходя из вкуса молока и условия, что 'лучше фермер не купит корову со вкусным молоком (TP), чем купит корову с не вкусным молоком (FP)'.

Для лучшего прогнозирования модели классификации требуются реальные данные о Сахаро-протеиновом отношении (СПО), т.к. этот признак сильнее остальных влияет на вкус молока, а также ЭКЕ и Сырой протеин.

Выводы о моделях линейной регрессии и логистической регрессии:

Для улучшения качества моделей линейной регрессии произведены следующие действия:
- определены входные признаки, имеющие наибольшую линейную связь с целевым (с учетом подгрупп входных признаков);
- устранены лишние признаки;
- устранена нелинейность между целевым и входными признаками;
- видоизменены имеющиеся признаки;
- добавлены новые признаки;
- масштабированы количественные, закодированы качественные признаки.

Улучить качество модели можно:
- погрузившись в сферу и выяснив ее специфические детали для более точной настройки модели;
- увеличив размер исходных данных, особенно выборки, для которой нужно сделать прогноз;
- уточнить признаки в данных cow_buy (СПО, ЭКЕ, Сырой протеин);

Выбор метрики для моделей классификации зависит от конкретной задачи бизнеса. При необходимости не допустить ошибку первого рода (FP) выбирают precition, при необходимости не допустить ошибку второго рода - recall.
Оценивая риск, например, отнести человека к классу 'террорист' или 'не террорист', лучше сделать ложноположительную оценку (FP) и проверить не террориста на наличие оружия, чем совершить ложноотрицательную оценку (FN) и пропустить человека с бомбой. ЗДесь выбираем метрику precition.

## Что использовано
Python, Numpy, Pandas, Matplotlib, Scipy, Seaborn, Sklearn. <br>
А также: Phik (для корреляций), Patsy (dmatrices), statsmodels.stats.outliers_influence (для проверки на мультиколлинеарность).
