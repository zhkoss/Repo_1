# Разработка решения, которое позволит персонализировать предложения постоянным клиентам для увеличения их покупательской активности

## Введение
Интернет-магазин продаёт разные товары: для детей, для дома, мелкую бытовую технику, косметику и даже продукты. Отчёт магазина за прошлый период показал, что активность покупателей начала снижаться. Привлекать новых клиентов уже не так эффективно: о магазине и так знает большая часть целевой аудитории. Возможный выход — удерживать активность постоянных клиентов. Сделать это можно с помощью персонализированных предложений.

## Цель исследования
Нужно построить модель, которая предскажет вероятность снижения покупательской активности клиента в следующие три месяца.

В исследование нужно включить дополнительные данные финансового департамента о прибыльности клиента: какой доход каждый покупатель приносил компании за последние три месяца.

Используя данные модели и данные о прибыльности клиентов, нужно выделить сегменты покупателей и разработать для них персонализированные предложения.

## Ход исследования
Решение задачи происходит в два этапа:
1. Разработка модели, которая предскажет вероятность снижения покупательской активности.
2. Выделение сегмента покупателей, его анализ и предложение, как увеличить его покупательскую активность. Используются данные моделирования, данные о прибыли покупателей и исходные данные (при необходимости).

## Общий вывод
Исходные данные содержат несколько таблиц с различными признаками. На этапе загрузки данных они были изучены. Потверждено их соответствие описанию в задании, выделен целевой признак.
Проведена предобработка данных, во время которой выявлены и удалены явные и неявные дубликаты.

Перед поиском лучшей модели был проведен исследовательский анализ данных. Рассмотрены количественные и качественные признаки, выявлены выбросы и аномальное значение. Корреляционный анализ показал взаимосвязи входных признаков между собой. Мультиколлинеарность не выявлена.

На следующем этапе с целью автоматизации процесса поиска лучшей модели с лучшими гиперпараметрами были созданы пайплайны.

В результате моделирования на тренировочных и тестовых данных была определена лучшая модель со следующими гиперпараметрами:
DecisionTreeClassifier(max_depth=4, max_features=3, random_state=42)

Выводы и предложения для сегментов покупателей: Были рассмотрены покупатели, разделенные по классам: класс 1 (покупательская активность снизилась), класс 0 (покупательская способность не изменилась). Учитывалась также их покупательская способность.

Стоит подольше задерживать пользователей на сайте: время просмотра, просмотры страниц за визит, просмотры категорий сильнее всего влияют на лояльность клиентов.

Нужно определить причины проседания двух категорий ('товары для детей' и 'техника для красоты и здоровья') по выручке в динамике по месяцам, по возможности их 'подтянуть', при этом не снижая роста категорий-лидеров (лидер - 'кухонная посуда').

У сегмента клиентов с высокой вероятностью отнесения к классу 1 (покупательская активность снизилась) и с высокой вероятностью отнесения к классу 2 (покупательская активность осталась прежней) высокое число покупок товаров для детей. Можно также таргетировать эту категорию: предлагать данные товары активнее, в т.ч. акционные.

## Что использовано
Python, Numpy, Pandas, Matplotlib, Scipy, Seaborn, Sklearn. <br>
А также: Phik (для корреляций), Patsy (dmatrices), statsmodels.stats.outliers_influence (для проверки на мультиколлинеарность), Shap (в помощь к оценке важности признаков)
