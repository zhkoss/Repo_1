# Создание модели машинного обучения, которая будет прогнозировать отток клиентов оператора связи "ТелеДом"

## Введение
Оператор связи «ТелеДом» хочет бороться с оттоком клиентов. Для этого его сотрудники начнут предлагать промокоды и специальные условия всем, кто планирует отказаться от услуг связи. Чтобы заранее находить таких пользователей, «ТелеДому» нужна модель, которая будет предсказывать, разорвёт ли абонент договор. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и услугах. <br>
Метрика качества: ROC-AUC (значение не менее 0.85).<br>
Метрики на тестовой выборке: ROC-AUC и accuracy.

## Цель исследования
На основе исходных данных обучить модель машинного обучения для прогноза оттока клиентов.

## Ход исследования
1. Загрузка данных;
2. Предобработка данных;
3. Исследовательский и корреляционный анализ данных;
4. Объединение данных;
5. Предобработка данных объединенного датафрейма;
6. Исследовательский анализ объединенного датафрейма;
7. Подготовка данных;
8. Обучение моделей машинного обучения;
9. Выбор лучшей модели;
10. Общий вывод и рекомендации заказчику.

## Общий вывод
В настоящем проекте были выполнены действия по созданию модели, которая будет предсказывать, разорвёт ли абонент договор. Для этого были выполнены следующие шаги:
1. Выявлен целевой признак.

2. Проведена предобработка данных:
- скорректированы наименования признаков;
- изменены типы некоторых данных;
- обработаны пропущенные значения.

3. Выполнен исследовательский анализ данных:
- с помощью графиков исследованы распределения количественных и качественных признаков;
- удалены некоторые признаки, добавлен новый contract_days, который учитывает продолжительность действия договора клиента;
- выявлен дисбаланс значений целевого признака.

4. Данные из четырех Dataframe объединены в один для дальнешего исследования.
5. Проведена предобработка данных объединенного dataframe:
- появившиеся пропуски устранен;
- выявлены дубликаты, однако, все значения customer_id - уникальны, поэтому - полные дубликаты отсутствуют.

6. Проведен исследовательский и корреляционный анализ объединенного датафрейма.
Четкого разделения на классы целевой переменной не прослеживается. Взаимосвязь целевого признака с входными выражена не сильно (использована шкала Чеддока).
Проведена проверка и дополнительная проверка с помощью VIF на наличие мультколлинеарности между признаками.
Распределения количественных признаков (в разрезе целевого признака) несимметричны (использованы графики KDE). В целом распределения значений для разных классов целевого признака похожи.
Определено, какие клиенты чаще расторгают договор:
тип оплаты (type): раз в года-два; тип платежа (payment_method): bank transfer (automatic) и credit card (automatic)'; пенсионеры; абоненты, у которых есть супруг/супруга; тип подключения: абоненты с оптоволокном (fiber optic); с подключенными дополнительными услугами.

7. Рассмотрена проблема дисбаланса классов целевого признака.
С целью минимизации последствий несбалансированного распределения целевого признака на этапе разработки данного проекта была произведена попытка устранения дисбаланса с помощью сэмплирования. Было искусственно увеличено количество значений минорного класса методом oversampling/upsampling (только для тренировочной выборки). Однако, upsampling в дальнейшем привел к переобучению модели, и было принято решение от него отказаться.
Данные подготовлены для дальнейшего моделирования (использованы пайплайны).
С помощью алгоритма уменьшения размерности UMAP произведена визуальная оценка разделения классов целевого признака: увеличилась уверенность в том, что можно успешно провести классификацию целевого признака.

8. Обучены 6 моделей классификации, для каждой был произведен перебор гиперпараметров, а также выполнена оценка качества работы этих моделей.

9. Выбрана лучшая модель - LGBM классификатор. Проведена ее оценка на тестовой выборке. Метрики показали значения, превышающие требуемые согласно заданию.
Также выполнена проверка модели на адекватность с помощью baseline модели Dummy Classifier.
В завершение входные признаки проанализированы на предмет важности каждого. Выполнен дополнительный анализ на данных, включающих мусорный признак.

**Рекомендации заказчику**
Метрики, используемые в данном проекте - обобщенные. Для более оптимальной настройки модели следует определить бизнес-метрики и по результатам 'откалибровать' модель с помощью порогов классификации: возможно, потребуется удержать клиентов, которые склонны уйти (Recall) или, наоборот, сдвинуть порог в сторону Precision. <br>
Следует помнить о дисбалансе классов: у мажорного класса 'клиент не уйдет' приемущество: модель лучше предсказывает его значения. Компании «ТелеДом» важно не упускать класс '1', а его доля очень низка относительно класса '0'.

Если планируется существенное увеличение объема входящих данных, следует оптимизировать их сбор и хранение:
- пересобрать таблицы с учетом того, что некоторые признаки не будут использованы в модели. Такие признаки можно хранить отдельно; <br>
- по возможности не допускать пропусков в данных; <br>
- изменить типы данных некоторых признаков на менее требовательные к памяти.

## Что использовано
Python, Numpy, Pandas, Matplotlib, Seaborn, Sklearn.
А также: Phik (для корреляций), Patsy (dmatrices), statsmodels.stats.outliers_influence (для проверки на мультиколлинеарность), Umap (для визуальной оценки разделения меток целевого признака).
